---
title: 使用git rebase合并多个commit提交
categories: ["Devops"]
tags: ["git"]
date: 2019-02-27 23:01:41 
author: gravel

---

在日常开发中，常常会遇到自己正在开发某个`feature`的时候，需要切到另外的分支去处理`bug`。于是先将未完成的功能`commit`到本地。处理完`bug`之后，再切回来开发，这种做法有一个坏处是，仓库`commit`的历史会很凌乱。不利于追踪排查历史问题。

<!--more-->

以上为前提条件，这种情况可以使用 `git rebase` 来处理，合并多个本地的`commit`，今天以这边文章的提交历史，来做个示范。

>注意，这种合并方式，只对未`push`到远端的`commit`有效

首先查看下这个仓库的提交历史记录：

```
git log 
```

输出如下图：

![1551287799586](20190228-1.png)

使用 `rebase`将多个`commit`合并成一个。

```
git rebase -i HEAD~[number_of_commits]
```

可以看到，我们这里有三条`commit`记录，只需要修改末尾的`number_of_commits`参数。

```
git rebase -i HEAD~3
```

终端输出如下图：

![1551288202815](20190228-2.png)

第一列是`rebase`具体执行的操作，其中操作可以选择，其中含义如下：

* `pick`，`git`会应用这个补丁，以同样的提交信息（`commit message`）保存提交

* `reword`，`git`会应用这个补丁，但需要重新编辑提交信息

* `edit`，`git`会应用这个补丁，但会因为`amending`而终止

* `squash`，`git`会应用这个补丁，但会与之前的提交合并

* `fixup`，`git`会应用这个补丁，但会丢掉提交日志

* `exec`，`git`会在`shell`中运行这个命令

这里我们将第一个提交保留，将第二第三个提交合并到第一个提交里面去，将第二个和第三个`commit`前的`pick`改成`s`，然后保存退出。输出如下图：

![1551288559899](20190228-3.png)

修改`commit`信息，保存，并退出。然后使用`git log` 查看`commit`记录:

![1551288728749](20190228-4.png)

可以看到，刚刚的三条记录已经被合并了。接下来只需要`push`到远端仓库就行了。